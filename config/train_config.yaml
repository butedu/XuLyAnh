# Configuration file for Smile Detection Training
# Cấu hình huấn luyện mô hình nhận diện nụ cười

# ============ Data Configuration ============
data:
  image_root: "data/images"
  split_dir: "data/processed/genki4k"
  output_dir: "models"
  image_size: [64, 64]

# ============ Training Hyperparameters ============
training:
  epochs: 50
  batch_size: 64
  learning_rate: 5.0e-4
  weight_decay: 1.0e-4  # L2 regularization
  
  # Learning rate scheduler
  scheduler:
    type: "cosine"  # Options: "step", "cosine", "reduce_on_plateau"
    warmup_epochs: 5
    min_lr: 1.0e-6
    # For step scheduler
    step_size: 10
    gamma: 0.5
  
  # Optimizer settings
  optimizer:
    type: "adamw"  # Options: "adam", "adamw", "sgd"
    momentum: 0.9  # Only for SGD
    betas: [0.9, 0.999]  # For Adam/AdamW

# ============ Model Architecture ============
model:
  name: "SmileNetV2"  # Options: "SmileNet", "SmileNetV2"
  dropout: 0.3
  use_se_block: true  # Squeeze-and-Excitation attention
  use_deep_residual: true  # Deeper residual blocks

# ============ Data Augmentation ============
augmentation:
  # Basic augmentation
  horizontal_flip: true
  random_rotation: 10  # degrees
  
  # Color augmentation
  color_jitter:
    brightness: 0.3
    contrast: 0.3
    saturation: 0.2
    hue: 0.1
  
  # Advanced augmentation
  random_erasing:
    probability: 0.3
    scale: [0.02, 0.15]
    ratio: [0.3, 3.3]
  
  gaussian_blur:
    probability: 0.2
    kernel_size: 5
  
  # Normalization (ImageNet stats)
  normalize:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]

# ============ Training Settings ============
settings:
  seed: 42
  num_workers: 4
  pin_memory: true
  device: "cuda"  # Options: "cuda", "cpu", "auto"
  
  # Mixed precision training (faster on NVIDIA GPU)
  use_amp: true  # Automatic Mixed Precision
  
  # Gradient clipping
  grad_clip:
    enabled: true
    max_norm: 1.0
  
  # Early stopping
  early_stopping:
    enabled: true
    patience: 15
    min_delta: 0.001  # Minimum improvement in F1 score
  
  # Checkpoint saving
  save_best_only: false  # Save all checkpoints or only best
  save_frequency: 5  # Save checkpoint every N epochs

# ============ Validation & Testing ============
validation:
  metric: "f1"  # Primary metric: "f1", "accuracy", "precision", "recall"
  test_after_training: true  # Run test set evaluation after training

# ============ Logging ============
logging:
  log_interval: 10  # Log every N batches
  tensorboard: false  # Enable TensorBoard logging
  wandb: false  # Enable Weights & Biases logging
